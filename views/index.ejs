<!doctype html>
<html>

<head>
  <%-include('head')%>
</head>

<body>
  <nav class="grey darken-3">
    <div class="title">
      <a style="display: flex; align-items: center">
        <img src="images/logo.png" alt="home" height="80" width="100" style="margin-top: -5px" />
        <span style="margin-bottom: 10px">ë‹¤ìˆë‹¤</span>
      </a>
    </div>
  </nav>

  <!-- <div class="icon-container">
    <a href="/api/auth/login" data-target="slide-out" class="sidenav-trigger right"><i class="material-icons"
        style="font-size: 45px; color: #ffffff">account_circle</i></a>
  </div> -->
  <% if(login==="yes" ) { %>
    <div class="icon-container">
      <a href="#" data-target="slide-out" class="sidenav-trigger right"><i class="material-icons"
          style="font-size: 45px; color: #ffffff">account_circle</i></a>
    </div>
    <ul id="slide-out" class="sidenav right-align">
      <img id="userProfileImage" alt="User Profile Picture"
        style="width: 250px; height: 250px; margin-right: 25px; margin-top: 25px;">
      <li>
        <p id="userNickName" style="padding: 0px 32px 25px; margin: 0px;"></p>
      </li>
      <li><a href="/api/user/mypage">ë§ˆì´í˜ì´ì§€</a></li>
      <li><a href="/api/auth/logout">ë¡œê·¸ì•„ì›ƒ</a></li>

    </ul>
    <% } else if(login==="no" ) { %>
      <div class="icon-container">
        <a href="/login" data-target="slide-out" class="sidenav-trigger right"><i class="material-icons"
            style="font-size: 45px; color: #ffffff">account_circle</i></a>
      </div>
      <% } %>

        <div class="category-bar">
          <a href="#" class="category-item">
            <i class="material-icons" style="color: #333">note</i>
            ê²Œì‹œíŒ
          </a>
          <a href="#" class="category-item">
            <i class="material-icons" style="color: #333">chat</i>
            ëŒ€í™”
          </a>
          <a href="#" class="category-item">
            <i class="material-icons" style="color: #333">desktop_windows</i>
            ëª¨ë‹ˆí„°
          </a>
          <a href="#" class="category-item">
            <i class="material-icons" style="color: #333">keyboard</i>
            í‚¤ë³´ë“œ
          </a>
          <a href="#" class="category-item">
            <i class="material-icons" style="color: #333">mouse</i>
            ë§ˆìš°ìŠ¤
          </a>
          <a href="#" class="category-item">
            <i class="material-icons" style="color: #333">gradient</i>
            ê·¸ë˜í”½
          </a>
          <a href="#" class="category-item">
            <i class="material-icons" style="color: #333">memory</i>
            ë©”ëª¨ë¦¬
          </a>
          <a href="#" class="category-item">
            <i class="material-icons" style="color: #333">laptop_chromebook</i>
            ë…¸íŠ¸ë¶
          </a>
        </div>

        <div class="post-container1">
          <div class="latest-post-container">
            <p>ìµœì‹  ê²Œì‹œë¬¼</p>
            <ul class="collection post-list">
              <% for (let i=0; i<5; i++){ %>
                <li class="collection-item" id="last-post-<%=i %>">ê²Œì‹œë¬¼ <%=i %>: ë‚´ìš©<%=i %>
                </li>
                <% } %>
            </ul>
          </div>

          <div class="popularity-post-container">
            <p>ì¢‹ì•„ìš” ë§ì€ ê²Œì‹œë¬¼</p>
            <ul class="collection post-list">
              <% for (let i=0; i<5; i++){ %>
                <li class="collection-item" id="like-post-<%=i %>">ê²Œì‹œë¬¼ <%=i %>: ë‚´ìš©<%=i %>
                </li>
                <% } %>
            </ul>
          </div>

          <div class="commets-post-container">
            <p>ë§ê¸€ ë§ì€ ê²Œì‹œë¬¼</p>
            <ul class="collection post-list">
              <% for (let i=0; i<5; i++){ %>
                <li class="collection-item" id="comment-post-<%=i %>">ê²Œì‹œë¬¼ <%=i %>: ë‚´ìš©<%=i %>
                </li>
                <% } %>
            </ul>
          </div>
        </div>

        <div class="post-container1">
          <div class="all-post-container">
            <p>ì „ì²´ ê²Œì‹œë¬¼</p>
            <ul class="collection post-list">
              <% for (let i=0; i<5; i++){ %>
                <li class="collection-item" id="total-post-<%=i %>">ê²Œì‹œë¬¼ <%=i %>: ë‚´ìš©<%=i %>
                </li>
                <% } %>
            </ul>
          </div>
        </div>

        <footer>
          <p>&copy; 2023 A-3 null ì‚¬ë‘í•˜ì§€ ì•Šì•„ ğŸ–¤</p>
        </footer>
</body>

<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
<script>
  console.log("ë°ì´í„°í…ŒìŠ¤íŠ¸");

  fetch('/api/post')
    .then(response => response.json())
    .then(data => {
      console.log(data)
      for (let i = 0; i < 5; i++) {
        const post = document.getElementById(`last-post-${i}`);
        post.innerText = data.data[i].title;
      }
      for (let i = 0; i < 5; i++) {
        const post = document.getElementById(`like-post-${i}`);
        post.innerText = data.data[i].title;
      }
      for (let i = 0; i < 5; i++) {
        const post = document.getElementById(`comment-post-${i}`);
        post.innerText = data.data[i].title;
      }
      for (let i = 0; i < 5; i++) {
        const post = document.getElementById(`total-post-${i}`);
        post.innerText = data.data[i].title;
      }

    })
    .catch(error => console.error('ì—ëŸ¬ ë°œìƒ:', error));

  fetch('/api/user/me')
    .then(response => response.json())
    .then(data => {
      console.log(data.data)
      const nickName = document.getElementById('userNickName')
      nickName.innerText = data.data.nickName
      const userImage = document.getElementById('userProfileImage')
      userImage.src = data.data.imgUrl


    }).catch(error => console.log(error))

  document.addEventListener("DOMContentLoaded", function () {
    var elems = document.querySelectorAll(".sidenav");
    var instances = M.Sidenav.init(elems, { edge: "right" });
  });
</script>

</html>